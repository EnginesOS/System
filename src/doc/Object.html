<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Object - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">BasicObject
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="ClientHTTPStream.html">ClientHTTPStream</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-assemble_params">#assemble_params</a>
    
    <li ><a href="#method-i-authenticate">#authenticate</a>
    
    <li ><a href="#method-i-authenticate-21">#authenticate!</a>
    
    <li ><a href="#method-i-build_uri">#build_uri</a>
    
    <li ><a href="#method-i-check_required">#check_required</a>
    
    <li ><a href="#method-i-clean_api_vars">#clean_api_vars</a>
    
    <li ><a href="#method-i-clean_params">#clean_params</a>
    
    <li ><a href="#method-i-command_usage">#command_usage</a>
    
    <li ><a href="#method-i-connection">#connection</a>
    
    <li ><a href="#method-i-downcase_keys">#downcase_keys</a>
    
    <li ><a href="#method-i-empty_array">#empty_array</a>
    
    <li ><a href="#method-i-empty_json">#empty_json</a>
    
    <li ><a href="#method-i-engine_service_hash_from_params">#engine_service_hash_from_params</a>
    
    <li ><a href="#method-i-engines_api">#engines_api</a>
    
    <li ><a href="#method-i-error_hash">#error_hash</a>
    
    <li ><a href="#method-i-fake_exception">#fake_exception</a>
    
    <li ><a href="#method-i-finialise_events_stream">#finialise_events_stream</a>
    
    <li ><a href="#method-i-get_engine">#get_engine</a>
    
    <li ><a href="#method-i-get_help_info">#get_help_info</a>
    
    <li ><a href="#method-i-get_service">#get_service</a>
    
    <li ><a href="#method-i-get_utilty">#get_utilty</a>
    
    <li ><a href="#method-i-handle_exeception">#handle_exeception</a>
    
    <li ><a href="#method-i-handle_resp">#handle_resp</a>
    
    <li ><a href="#method-i-is_admin_token_valid-3F">#is_admin_token_valid?</a>
    
    <li ><a href="#method-i-is_user_token_valid-3F">#is_user_token_valid?</a>
    
    <li ><a href="#method-i-is_user_token_valid_admin-3F">#is_user_token_valid_admin?</a>
    
    <li ><a href="#method-i-json_parser">#json_parser</a>
    
    <li ><a href="#method-i-load_token">#load_token</a>
    
    <li ><a href="#method-i-log_error">#log_error</a>
    
    <li ><a href="#method-i-login">#login</a>
    
    <li ><a href="#method-i-managed_container_as_json">#managed_container_as_json</a>
    
    <li ><a href="#method-i-managed_containers_to_json">#managed_containers_to_json</a>
    
    <li ><a href="#method-i-match_address_params">#match_address_params</a>
    
    <li ><a href="#method-i-match_params">#match_params</a>
    
    <li ><a href="#method-i-no_op_timer">#no_op_timer</a>
    
    <li ><a href="#method-i-no_oploop_timer">#no_oploop_timer</a>
    
    <li ><a href="#method-i-optional_params">#optional_params</a>
    
    <li ><a href="#method-i-perform_del">#perform_del</a>
    
    <li ><a href="#method-i-perform_delete">#perform_delete</a>
    
    <li ><a href="#method-i-perform_get">#perform_get</a>
    
    <li ><a href="#method-i-perform_post">#perform_post</a>
    
    <li ><a href="#method-i-perform_put">#perform_put</a>
    
    <li ><a href="#method-i-post_params">#post_params</a>
    
    <li ><a href="#method-i-process_args">#process_args</a>
    
    <li ><a href="#method-i-process_body">#process_body</a>
    
    <li ><a href="#method-i-process_flag">#process_flag</a>
    
    <li ><a href="#method-i-read_stdin_data">#read_stdin_data</a>
    
    <li ><a href="#method-i-read_stdin_json">#read_stdin_json</a>
    
    <li ><a href="#method-i-required_params">#required_params</a>
    
    <li ><a href="#method-i-rest_del">#rest_del</a>
    
    <li ><a href="#method-i-rest_delete">#rest_delete</a>
    
    <li ><a href="#method-i-rest_get">#rest_get</a>
    
    <li ><a href="#method-i-rest_post">#rest_post</a>
    
    <li ><a href="#method-i-rest_put">#rest_put</a>
    
    <li ><a href="#method-i-rest_stream_put">#rest_stream_put</a>
    
    <li ><a href="#method-i-return_boolean">#return_boolean</a>
    
    <li ><a href="#method-i-return_error">#return_error</a>
    
    <li ><a href="#method-i-return_error_array">#return_error_array</a>
    
    <li ><a href="#method-i-return_json">#return_json</a>
    
    <li ><a href="#method-i-return_json_array">#return_json_array</a>
    
    <li ><a href="#method-i-return_text">#return_text</a>
    
    <li ><a href="#method-i-return_true">#return_true</a>
    
    <li ><a href="#method-i-send_encoded_exception">#send_encoded_exception</a>
    
    <li ><a href="#method-i-service_hash_from_params">#service_hash_from_params</a>
    
    <li ><a href="#method-i-service_service_hash_from_params">#service_service_hash_from_params</a>
    
    <li ><a href="#method-i-source_is_service-3F">#source_is_service?</a>
    
    <li ><a href="#method-i-stream_file">#stream_file</a>
    
    <li ><a href="#method-i-stream_io">#stream_io</a>
    
    <li ><a href="#method-i-stream_put">#stream_put</a>
    
    <li ><a href="#method-i-token_owner">#token_owner</a>
    
    <li ><a href="#method-i-token_owner_password">#token_owner_password</a>
    
    <li ><a href="#method-i-uadmin_del">#uadmin_del</a>
    
    <li ><a href="#method-i-uadmin_get">#uadmin_get</a>
    
    <li ><a href="#method-i-uadmin_post">#uadmin_post</a>
    
    <li ><a href="#method-i-uadmin_put">#uadmin_put</a>
    
    <li ><a href="#method-i-uadmin_response">#uadmin_response</a>
    
    <li ><a href="#method-i-uconnection">#uconnection</a>
    
    <li ><a href="#method-i-unauthenticated">#unauthenticated</a>
    
    <li ><a href="#method-i-valid-3F">#valid?</a>
    
    <li ><a href="#method-i-warning_hash">#warning_hash</a>
    
    <li ><a href="#method-i-write_response">#write_response</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Object">
  <h1 id="class-Object" class="class">
    class Object
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-assemble_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">assemble_params</span><span
            class="method-args">(ps, address_params, required_params = nil, accept_params = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="assemble_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 13</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">assemble_params</span>(<span class="ruby-identifier">ps</span>, <span class="ruby-identifier">address_params</span>, <span class="ruby-identifier">required_params</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">accept_params</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">EnginesException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">error_hash</span>(<span class="ruby-string">&#39;No params Supplied&#39;</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">deal_with_json</span>(<span class="ruby-identifier">ps</span>) <span class="ruby-comment"># actually just symbolize</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">address_params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">a_params</span> = {}
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">a_params</span> = <span class="ruby-identifier">match_address_params</span>(<span class="ruby-identifier">ps</span>, <span class="ruby-identifier">address_params</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">EnginesException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">error_hash</span>(<span class="ruby-string">&#39;Missing Address Parameters &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">address_params</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; but only have:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">to_s</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">a_params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">required_params</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">required_params</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">required_params</span> <span class="ruby-operator">==</span> <span class="ruby-value">:all</span>
      <span class="ruby-identifier">a_params</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">ps</span>[<span class="ruby-value">:api_vars</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:api_vars</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ps</span>[<span class="ruby-value">:api_vars</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">a_params</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r_params</span> = <span class="ruby-identifier">required_params</span>(<span class="ruby-identifier">ps</span>, <span class="ruby-identifier">required_params</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">EnginesException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">error_hash</span>(<span class="ruby-string">&#39;Missing Parameters &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">required_params</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; but only have:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">to_s</span>)) <span class="ruby-keyword">if</span> <span class="ruby-identifier">r_params</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">a_params</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">r_params</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r_params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">accept_params</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">accept_params</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">o_params</span> = <span class="ruby-identifier">optional_params</span>(<span class="ruby-identifier">ps</span>, <span class="ruby-identifier">accept_params</span>)
    <span class="ruby-identifier">a_params</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">o_params</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">o_params</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">a_params</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-authenticate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">authenticate</span><span
            class="method-args">(attempted_password)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="authenticate-source">
            <pre><span class="ruby-comment"># File server/model.rb, line 19</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authenticate</span>(<span class="ruby-identifier">attempted_password</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">attempted_password</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-authenticate-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">authenticate!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="authenticate-21-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 20</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authenticate!</span>
  <span class="ruby-identifier">access_granted</span> = <span class="ruby-identifier">is_admin_token_valid?</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCESS_TOKEN&#39;</span>], <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;REMOTE_ADDR&#39;</span>])
  <span class="ruby-operator">!</span><span class="ruby-identifier">access_granted</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">fail!</span>(<span class="ruby-string">&#39;Not logged in&#39;</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">success!</span>(<span class="ruby-identifier">access_granted</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-build_uri" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">build_uri</span><span
            class="method-args">(splat)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="build_uri-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">build_uri</span>(<span class="ruby-identifier">splat</span>)
  <span class="ruby-identifier">uri</span> = <span class="ruby-string">&#39;/v0/&#39;</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">splat</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">splat</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">|</span>
      <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Built &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">uri</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-check_required" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">check_required</span><span
            class="method-args">(params, key, is_required)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="check_required-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">check_required</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">is_required</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">is_required</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">p</span> <span class="ruby-value">:missing_key</span>
    <span class="ruby-identifier">p</span> <span class="ruby-identifier">key</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-clean_api_vars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clean_api_vars</span><span
            class="method-args">(params)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="clean_api_vars-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clean_api_vars</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;I got &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">v</span> = <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>
    {}
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;I give &#39;</span> <span class="ruby-operator">+</span>  <span class="ruby-identifier">v</span>[<span class="ruby-value">:api_vars</span>].<span class="ruby-identifier">to_s</span>  )
    <span class="ruby-identifier">v</span>[<span class="ruby-value">:api_vars</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-clean_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clean_params</span><span
            class="method-args">(params)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="clean_params-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 151</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">params</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;splat&#39;</span>)
    <span class="ruby-identifier">params</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;captures&#39;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">params</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-command_usage" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">command_usage</span><span
            class="method-args">(mesg=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="command_usage-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">command_usage</span>(<span class="ruby-identifier">mesg</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;Incorrect usage&quot;</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">mesg</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">get_help_info</span>
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-connection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">connection</span><span
            class="method-args">(content_type = 'application/json_parser')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="connection-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connection</span>(<span class="ruby-identifier">content_type</span> = <span class="ruby-string">&#39;application/json_parser&#39;</span>)
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">headers</span> = {
    <span class="ruby-string">&#39;content_type&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">content_type</span>,
    <span class="ruby-string">&#39;ACCESS_TOKEN&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">load_token</span>
  }
  <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">delete</span>[<span class="ruby-string">&#39;ACCESS_TOKEN&#39;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;ACCESS_TOKEN&#39;</span>].<span class="ruby-identifier">nil?</span>
  <span class="ruby-ivar">@connection</span> = <span class="ruby-constant">Excon</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@base_url</span>,
  <span class="ruby-identifier">debug_request</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">debug_response</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">ssl_verify_peer</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>,
  <span class="ruby-identifier">persistent</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">headers</span><span class="ruby-operator">:</span> <span class="ruby-identifier">headers</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@connection</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-ivar">@connection</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to open base url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@base_url</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@retries</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">5</span>
    <span class="ruby-ivar">@retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to open base url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@base_url</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; after &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@retries</span>.<span class="ruby-identifier">to_s</span> = <span class="ruby-string">&#39; attempts&#39;</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span><span class="ruby-identifier">e</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Uncatch E &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>)
  
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-downcase_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">downcase_keys</span><span
            class="method-args">(hash)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="downcase_keys-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">downcase_keys</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">k</span>.<span class="ruby-identifier">downcase</span>, <span class="ruby-identifier">downcase_keys</span>(<span class="ruby-identifier">v</span>)]}.<span class="ruby-identifier">to_h</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-empty_array" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">empty_array</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="empty_array-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty_array</span>
  <span class="ruby-ivar">@empty_array</span> <span class="ruby-operator">||=</span> [].<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-empty_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">empty_json</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="empty_json-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty_json</span>
  <span class="ruby-ivar">@empty_json</span> <span class="ruby-operator">||=</span> {}.<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-engine_service_hash_from_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">engine_service_hash_from_params</span><span
            class="method-args">(params, search = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="engine_service_hash_from_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">engine_service_hash_from_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">search</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">service_hash_from_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">search</span>)
  <span class="ruby-identifier">hash</span>[<span class="ruby-value">:parent_engine</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;engine_name&#39;</span>]
  <span class="ruby-identifier">hash</span>[<span class="ruby-value">:container_type</span>] = <span class="ruby-string">&#39;app&#39;</span>
  <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-engines_api" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">engines_api</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="engines_api-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 6</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">engines_api</span>
  <span class="ruby-identifier">$engines_api</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">PublicApi</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">EnginesCore</span>.<span class="ruby-identifier">new</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-error_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">error_hash</span><span
            class="method-args">(mesg, *params)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="error_hash-source">
            <pre><span class="ruby-comment"># File server/helpers/errors.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">error_hash</span>(<span class="ruby-identifier">mesg</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">params</span>)
  {
    <span class="ruby-identifier">error_type</span><span class="ruby-operator">:</span> <span class="ruby-value">:error</span>,
    <span class="ruby-identifier">params</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>,
    <span class="ruby-identifier">source</span><span class="ruby-operator">:</span> <span class="ruby-identifier">caller</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>],
    <span class="ruby-identifier">system</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;api&#39;</span>,
    <span class="ruby-identifier">error_mesg</span><span class="ruby-operator">:</span> <span class="ruby-identifier">mesg</span>
  }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-fake_exception" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fake_exception</span><span
            class="method-args">(api_exception)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="fake_exception-source">
            <pre><span class="ruby-comment"># File server/helpers/errors.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fake_exception</span>(<span class="ruby-identifier">api_exception</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;faking it&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">api_exception</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">caller</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">10</span>].<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;unauthorised&#39;</span>
    <span class="ruby-identifier">status_code</span> = <span class="ruby-value">403</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;faking unauthorised&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">status_code</span> = <span class="ruby-value">404</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">status_code</span> = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:status</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:status</span>)
  <span class="ruby-identifier">error_mesg</span> = {
    <span class="ruby-identifier">error_object</span><span class="ruby-operator">:</span> {}
  }
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:route</span>] = <span class="ruby-identifier">request</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:route</span>] = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">fullpath</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:error_object</span>] = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">return_text</span>(<span class="ruby-identifier">error_mesg</span>, <span class="ruby-identifier">status_code</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-finialise_events_stream" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">finialise_events_stream</span><span
            class="method-args">(events_stream, timer)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="finialise_events_stream-source">
            <pre><span class="ruby-comment"># File server/api/containers/containers.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">finialise_events_stream</span>(<span class="ruby-identifier">events_stream</span>, <span class="ruby-identifier">timer</span>)
  <span class="ruby-identifier">events_stream</span>.<span class="ruby-identifier">stop</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">events_stream</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">cancel</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_engine" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_engine</span><span
            class="method-args">(engine_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_engine-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 14</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_engine</span>(<span class="ruby-identifier">engine_name</span>)
  <span class="ruby-identifier">engines_api</span>.<span class="ruby-identifier">loadManagedEngine</span>(<span class="ruby-identifier">engine_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_help_info" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_help_info</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_help_info-source">
            <pre><span class="ruby-comment"># File client/cmdline_args.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_help_info</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;
    Options
   -v 
   -p password
   -u user
   -t token
   --port port
   --host host
   --url url
  --prefix prefix
  
  --url overides the following settings --host --port --prefix
  -v sets verbose
  Command &#39;</span>)

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_service" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_service</span><span
            class="method-args">(service_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_service-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_service</span>(<span class="ruby-identifier">service_name</span>)
  <span class="ruby-identifier">engines_api</span>.<span class="ruby-identifier">loadManagedService</span>(<span class="ruby-identifier">service_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_utilty" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_utilty</span><span
            class="method-args">(utilty_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_utilty-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 18</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_utilty</span>(<span class="ruby-identifier">utilty_name</span>)
  <span class="ruby-identifier">engines_api</span>.<span class="ruby-identifier">loadManagedUtilty</span>(<span class="ruby-identifier">utilty_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-handle_exeception" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">handle_exeception</span><span
            class="method-args">(e)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="handle_exeception-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 20</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_exeception</span>(<span class="ruby-identifier">e</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span>)
    <span class="ruby-identifier">status</span>(<span class="ruby-value">405</span>)
    {
      <span class="ruby-identifier">error_object</span><span class="ruby-operator">:</span> {
      <span class="ruby-identifier">error_mesg</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Failed to open base url http://uadmin:8000&#39;</span>
      }
    }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">status</span>(<span class="ruby-value">405</span>)
    {
      <span class="ruby-identifier">error_object</span><span class="ruby-operator">:</span> {
      <span class="ruby-identifier">error_mesg</span><span class="ruby-operator">:</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>
      }
    }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-handle_resp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">handle_resp</span><span
            class="method-args">(resp, expect_json = true)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="handle_resp-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_resp</span>(<span class="ruby-identifier">resp</span>, <span class="ruby-identifier">expect_json</span> = <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-comment">#  STDERR.puts(&#39;GOT JSON&#39; + resp.body)</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">400</span>
    <span class="ruby-identifier">log_error</span>(<span class="ruby-string">&quot;Error &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_s</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-string">&#39;fail&#39;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-value">204</span>   <span class="ruby-comment"># nodata but all good happens on del</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-string">&#39;OK&#39;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">200</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">300</span>
    <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">body</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">log_error</span>(<span class="ruby-string">&quot;Un exepect response from system&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>

 <span class="ruby-comment"># STDERR.puts(&#39;GOT body &#39; + resp.body + &quot;\nas JSON:&quot; +  expect_json.to_s) </span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">expect_json</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-comment">#  STDERR.puts(&#39;GOT JSON&#39; + resp.body)</span>
    <span class="ruby-identifier">o</span> = <span class="ruby-identifier">json_parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">resp</span>.<span class="ruby-identifier">body</span>)
    <span class="ruby-comment">#o = JSON.parse(resp.body)</span>
   <span class="ruby-comment"># STDERR.puts(&#39;O IS&#39; + o.class.name)</span>
    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">body</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">log_error</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with :&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">resp</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">log_error</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-is_admin_token_valid-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">is_admin_token_valid?</span><span
            class="method-args">(token, ip = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="is_admin_token_valid-3F-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_admin_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">is_admin_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-is_user_token_valid-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">is_user_token_valid?</span><span
            class="method-args">(token, ip = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="is_user_token_valid-3F-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_user_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">is_user_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-is_user_token_valid_admin-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">is_user_token_valid_admin?</span><span
            class="method-args">(token, ip = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="is_user_token_valid_admin-3F-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_user_token_valid_admin?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">is_admin_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span>)
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">is_user_token_valid?</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">ip</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">get_token_user</span>(<span class="ruby-identifier">token</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&#39;admin&#39;</span> <span class="ruby-operator">||</span>  <span class="ruby-identifier">$engines_api</span>.<span class="ruby-identifier">get_token_user</span>(<span class="ruby-identifier">token</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&#39;cn=Administrator,ou=People,dc=engines,dc=internal&#39;</span>
      <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-json_parser" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">json_parser</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="json_parser-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 90</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">json_parser</span>
  <span class="ruby-ivar">@json_parser</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">FFI_Yajl</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">symbolize_keys</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load_token" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_token</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="load_token-source">
            <pre><span class="ruby-comment"># File client/client_login.rb, line 10</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_token</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/.engines_token&#39;</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/.engines_token&#39;</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>] = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>].<span class="ruby-identifier">strip</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-log_error" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">log_error</span><span
            class="method-args">(*args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="log_error-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 18</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">log_error</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@silent</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
     
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@verbose</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">64</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-login" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">login</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="login-source">
            <pre><span class="ruby-comment"># File client/client_login.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">login</span>
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">rest_post</span>(<span class="ruby-string">&#39;/v0/system/login/&#39;</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">r</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>] = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\&quot;/</span>,<span class="ruby-string">&#39;&#39;</span>)
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">home</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/.engines_token&#39;</span>,<span class="ruby-string">&#39;w+&#39;</span>)
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">write</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;access_token&#39;</span>])
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-managed_container_as_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">managed_container_as_json</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="managed_container_as_json-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">managed_container_as_json</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">return_json</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_h</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-managed_containers_to_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">managed_containers_to_json</span><span
            class="method-args">(containers)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="managed_containers_to_json-source">
            <pre><span class="ruby-comment"># File server/helpers/helpers.rb, line 34</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">managed_containers_to_json</span>(<span class="ruby-identifier">containers</span>)
  <span class="ruby-identifier">return_json_array</span>(<span class="ruby-identifier">containers</span>, <span class="ruby-value">404</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">containers</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">containers</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">res</span> = []
    <span class="ruby-identifier">containers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">res</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_h</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">return_json_array</span>(<span class="ruby-identifier">res</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">return_json</span>(<span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_h</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-match_address_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match_address_params</span><span
            class="method-args">(params, keys)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="match_address_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match_address_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">match_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>, <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-match_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match_params</span><span
            class="method-args">(params, keys, is_required = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="match_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>, <span class="ruby-identifier">is_required</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">keys</span> <span class="ruby-operator">==</span> <span class="ruby-value">:all</span>
    <span class="ruby-identifier">params</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">cparams</span> = {}
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-keyword">for</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">keys</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">check_required</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">is_required</span>)
        <span class="ruby-identifier">cparams</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">check_required</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>, <span class="ruby-identifier">is_required</span>)
      <span class="ruby-identifier">cparams</span>[<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">keys</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">cparams</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-no_op_timer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">no_op_timer</span><span
            class="method-args">(out)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="no_op_timer-source">
            <pre><span class="ruby-comment"># File server/api/containers/containers.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">no_op_timer</span>(<span class="ruby-identifier">out</span>)
  <span class="ruby-identifier">no_op</span> = {<span class="ruby-identifier">no_op</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>}.<span class="ruby-identifier">to_json</span>
  <span class="ruby-identifier">timer</span> = <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-constant">PeriodicTimer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">25</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">out</span>.<span class="ruby-identifier">closed?</span>
      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;NOOP found OUT IS CLOSED: &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">to_s</span>)
      <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">cancel</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">no_op</span> <span class="ruby-comment"># unless lock_timer == true</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;\n&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">timer</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-no_oploop_timer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">no_oploop_timer</span><span
            class="method-args">(out)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="no_oploop_timer-source">
            <pre><span class="ruby-comment"># File server/api/containers/containers.rb, line 18</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">no_oploop_timer</span>(<span class="ruby-identifier">out</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;/opt/engines/src/server/keep_alive_nooper.rb&#39;</span>
  <span class="ruby-identifier">timer</span> = <span class="ruby-constant">KeepAliveNooper</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">timer</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">out</span>)
  <span class="ruby-identifier">timer</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-optional_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">optional_params</span><span
            class="method-args">(params, keys)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="optional_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">optional_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">mparams</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:api_vars</span>]
  <span class="ruby-identifier">mparams</span> = <span class="ruby-identifier">params</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">mparams</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">match_params</span>(<span class="ruby-identifier">mparams</span>, <span class="ruby-identifier">keys</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-perform_del" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform_del</span><span
            class="method-args">(time_out = 35)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="perform_del-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 61</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">perform_del</span>(<span class="ruby-identifier">time_out</span> = <span class="ruby-value">35</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">rest_del</span>(<span class="ruby-ivar">@route</span>, <span class="ruby-identifier">time_out</span>)
  <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-perform_delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform_delete</span><span
            class="method-args">(params = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="perform_delete-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 85</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">perform_delete</span>(<span class="ruby-identifier">params</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">rest_delete</span>(<span class="ruby-ivar">@route</span>, <span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-perform_get" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform_get</span><span
            class="method-args">(time_out = 34)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="perform_get-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">perform_get</span>(<span class="ruby-identifier">time_out</span> = <span class="ruby-value">34</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">rest_get</span>(<span class="ruby-ivar">@route</span>, <span class="ruby-identifier">time_out</span>)
  <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-perform_post" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform_post</span><span
            class="method-args">(params, content_type='application/json')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="perform_post-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">perform_post</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">content_type</span>=<span class="ruby-string">&#39;application/json&#39;</span>)
  <span class="ruby-identifier">post_params</span> = {<span class="ruby-identifier">api_vars</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>}
  <span class="ruby-identifier">rest_post</span>(<span class="ruby-ivar">@route</span>,<span class="ruby-identifier">post_params</span>, <span class="ruby-identifier">content_type</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-perform_put" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform_put</span><span
            class="method-args">(params, content_type = 'application/json')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="perform_put-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">perform_put</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">content_type</span> = <span class="ruby-string">&#39;application/json&#39;</span>)
  <span class="ruby-identifier">post_params</span> = {<span class="ruby-identifier">api_vars</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>}
  <span class="ruby-comment">#STDERR.puts(&#39;Posting &#39; + post_params.to_s)</span>
  <span class="ruby-identifier">rest_put</span>(<span class="ruby-ivar">@route</span>, <span class="ruby-identifier">post_params</span>, <span class="ruby-identifier">content_type</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-post_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">post_params</span><span
            class="method-args">(request)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="post_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">post_params</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;rack.input&#39;</span>].<span class="ruby-identifier">read</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">json_parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-keyword">else</span>
    {}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39; POST Parse Error &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; on &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>)
  {}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-process_args" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">process_args</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="process_args-source">
            <pre><span class="ruby-comment"># File client/cmdline_args.rb, line 1</span>
<span class="ruby-keyword">def</span>  <span class="ruby-identifier">process_args</span>()
  <span class="ruby-identifier">r</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">params</span> = {}
  <span class="ruby-keyword">while</span> <span class="ruby-constant">ARGV</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;-&#39;</span>)
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">process_flag</span>(<span class="ruby-constant">ARGV</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">params</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">r</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">params</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-keyword">return</span>(<span class="ruby-string">&#39;Error:Problem with arg &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">ARGV</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-process_body" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">process_body</span><span
            class="method-args">(body)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="process_body-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">process_body</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;RAW body &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">body</span> =  <span class="ruby-identifier">body</span>[<span class="ruby-value">:api_vars</span>]
    <span class="ruby-identifier">body</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_json</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;body to sned&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">body</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-process_flag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">process_flag</span><span
            class="method-args">(flag, params)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="process_flag-source">
            <pre><span class="ruby-comment"># File client/cmdline_args.rb, line 14</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">process_flag</span>(<span class="ruby-identifier">flag</span>, <span class="ruby-identifier">params</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">flag</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--http&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_https</span>] = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--https&#39;</span>
      <span class="ruby-identifier">params</span>[<span class="ruby-value">:use_https</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;-v&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:verbose</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;-p&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:password</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;-s&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:verbose</span>] = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:silent</span>] = <span class="ruby-keyword">true</span> 
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;-u&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:username</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;-t&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:access_token</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--host&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:host</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--port&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:port</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--url&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:base_url</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;--prefix&#39;</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:prefix</span>] = <span class="ruby-constant">ARGV</span>[<span class="ruby-value">1</span>]
    <span class="ruby-constant">ARGV</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span>(<span class="ruby-string">&#39;Error:Unknown option &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">flag</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-keyword">return</span>(<span class="ruby-string">&#39;Error:Problem with option &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">flag</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-read_stdin_data" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_stdin_data</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="read_stdin_data-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_stdin_data</span>
  <span class="ruby-identifier">stdin_data</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;timeout&#39;</span>
  <span class="ruby-identifier">status</span> = <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-value">63</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">while</span> <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">gets</span>
      <span class="ruby-identifier">stdin_data</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">$_</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">stdin_data</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Timeout on data read from stdin&quot;</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">log_exception</span>(<span class="ruby-identifier">e</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-read_stdin_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">read_stdin_json</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="read_stdin_json-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read_stdin_json</span>
  <span class="ruby-identifier">json_parser</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">read_stdin_data</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-required_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">required_params</span><span
            class="method-args">(params, keys)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="required_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">required_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">mparams</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:api_vars</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mparams</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">match_params</span>(<span class="ruby-identifier">mparams</span>, <span class="ruby-identifier">keys</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_del" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_del</span><span
            class="method-args">(uri, params=nil, time_out=23)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rest_del-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_del</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">params</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">time_out</span>=<span class="ruby-value">23</span>)
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:delete</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:delete</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@retries</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
    <span class="ruby-ivar">@retries</span> <span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; after &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@retries</span>.<span class="ruby-identifier">to_s</span> = <span class="ruby-string">&#39; attempts&#39;</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; delete with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_delete</span><span
            class="method-args">(uri, params=nil, time_out = 20)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rest_delete-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 228</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_delete</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">params</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">time_out</span> = <span class="ruby-value">20</span>)
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
  <span class="ruby-comment"># params = add_access(params)</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:delete</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>) <span class="ruby-comment">#,:body =&gt; params.to_json)</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:delete</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-identifier">exit</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@retries</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
      <span class="ruby-ivar">@retries</span> <span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">retry</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; after &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@retries</span>.<span class="ruby-identifier">to_s</span> = <span class="ruby-string">&#39; attempts&#39;</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_get" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_get</span><span
            class="method-args">(uri, time_out = 135, params = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rest_get-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 137</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_get</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">time_out</span> = <span class="ruby-value">135</span>, <span class="ruby-identifier">params</span> = <span class="ruby-keyword">nil</span>)

  <span class="ruby-identifier">time_out</span> = <span class="ruby-ivar">@wait_for</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@wait_for</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
<span class="ruby-comment">#  STDERR.puts(&#39;Waiting for &#39; + time_out.to_s)</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>({<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:get</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>})
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">request</span>({<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:get</span>, <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span>})
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; R &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@retries</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@retries</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">5</span>
    <span class="ruby-ivar">@retries</span> <span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; after &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@retries</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; attempts&#39;</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_post" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_post</span><span
            class="method-args">(uri, params, content_type, time_out = 44 )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rest_post-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_post</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">content_type</span>, <span class="ruby-identifier">time_out</span> = <span class="ruby-value">44</span> )  
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>(<span class="ruby-identifier">content_type</span>).<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, 
                                           <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:post</span>, 
                                           <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>, 
                                           <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span>) <span class="ruby-comment">#,:body =&gt; params.to_json)</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>(<span class="ruby-identifier">content_type</span>).<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, 
                                           <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:post</span>, 
                                           <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-identifier">exit</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span>
<span class="ruby-comment">#    if @retries &lt; 10</span>
<span class="ruby-comment">#      @retries +=1</span>
<span class="ruby-comment">#      sleep 1</span>
<span class="ruby-comment">#      retry</span>
<span class="ruby-comment">#    end</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span> )
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:api_vars</span>][<span class="ruby-value">:data</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_put" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_put</span><span
            class="method-args">(uri, params, content_type, time_out = 44 )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rest_put-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 193</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_put</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">content_type</span>, <span class="ruby-identifier">time_out</span> = <span class="ruby-value">44</span> )  
  <span class="ruby-ivar">@retries</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">params</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_json</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;application/json_parser&#39;</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>(<span class="ruby-identifier">content_type</span>).<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, 
                                           <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:put</span>, 
                                           <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>, 
                                           <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">params</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-identifier">connection</span>(<span class="ruby-identifier">content_type</span>).<span class="ruby-identifier">request</span>(<span class="ruby-identifier">read_timeout</span><span class="ruby-operator">:</span> <span class="ruby-identifier">time_out</span>, 
                                           <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:put</span>, 
                                           <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-identifier">exit</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
<span class="ruby-comment">#    if @retries &lt; 10</span>
<span class="ruby-comment">#      @retries +=1</span>
<span class="ruby-comment">#      sleep 1</span>
<span class="ruby-comment">#      retry</span>
<span class="ruby-comment">#    end</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to puy url &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:api_vars</span>][<span class="ruby-value">:data</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with path:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;params:&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">params</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rest_stream_put" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rest_stream_put</span><span
            class="method-args">(uri, data_io)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>def stream_connection(uri_s, stream_reader)</p>

<pre>headers = {
   &#39;content_type&#39; =&gt; &#39;application/octet-stream&#39;,
   &#39;ACCESS_TOKEN&#39; =&gt; load_token,
   &#39;Transfer-Encoding&#39; =&gt; &#39;chunked&#39;
}
uri = URI(@base_url + uri_s)
STDERR.puts(&#39;uri &#39; + uri.to_s)
conn = Net::HTTP.new(uri.host, uri.port)  
conn.use_ssl = true
conn.verify_mode = OpenSSL::SSL::VERIFY_NONE
request = Net::HTTP::Put.new(uri.request_uri, headers)
STDERR.puts request.inspect
request.body_stream = stream_reader
conn.request(request)
rescue StandardError =&gt; e
STDERR.puts(&#39;socket stream closed &#39; + e.to_s + e.backtrace.to_s)
end</pre>
          
          

          
          <div class="method-source-code" id="rest_stream_put-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rest_stream_put</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">data_io</span>)
 <span class="ruby-comment">#stream_handler = Streamer.new(data_io)</span>
 <span class="ruby-comment">#r = stream_connection(uri, stream_handler)</span>
  <span class="ruby-identifier">r</span> =  <span class="ruby-identifier">stream_file</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">data_io</span>)
<span class="ruby-comment">#    stream_handler.stream = sc</span>
<span class="ruby-comment">#  r = sc.request(</span>
<span class="ruby-comment">#  method: :put,</span>
 <span class="ruby-comment"># read_timeout: 3600,</span>
 <span class="ruby-comment"># path: uri,</span>
 <span class="ruby-comment"># body: nil</span>
<span class="ruby-comment">#  )</span>
<span class="ruby-comment">#  stream_handler.close</span>
<span class="ruby-comment">#  stream_handler.close</span>
  <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)

<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
<span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;socket stream closed &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-comment">#stream_handler.close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_boolean" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_boolean</span><span
            class="method-args">(v, s = 200)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_boolean-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_boolean</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">s</span> = <span class="ruby-value">200</span>)
  <span class="ruby-identifier">v</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-comment"># meths return nil and when error they raise an exception</span>
  <span class="ruby-identifier">return_text</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_error" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_error</span><span
            class="method-args">(error, nil_result = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_error-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_error</span>(<span class="ruby-identifier">error</span>, <span class="ruby-identifier">nil_result</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-comment"># STDERR.puts(&#39; RETURN ERROR!!!!!!!!&#39; )</span>
  <span class="ruby-identifier">content_type</span> <span class="ruby-string">&#39;application/json&#39;</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Access-Control-Allow-Origin&#39;</span>] =<span class="ruby-string">&#39;*&#39;</span>
  <span class="ruby-comment"># FIXME: take this from the error if avail</span>
  <span class="ruby-identifier">status</span>(<span class="ruby-value">403</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">error</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">nil_result</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">error</span>.<span class="ruby-identifier">to_json</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_error_array" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_error_array</span><span
            class="method-args">(error)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_error_array-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 70</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_error_array</span>(<span class="ruby-identifier">error</span>)
  <span class="ruby-identifier">return_error</span>(<span class="ruby-identifier">error</span>, <span class="ruby-identifier">empty_array</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_json</span><span
            class="method-args">(r, s = 202)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_json-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_json</span>(<span class="ruby-identifier">r</span>, <span class="ruby-identifier">s</span> = <span class="ruby-value">202</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">EnginesError</span>)
    <span class="ruby-identifier">return_error</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-string">&#39;application/json&#39;</span>
    <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Access-Control-Allow-Origin&#39;</span>] =<span class="ruby-string">&#39;*&#39;</span>
    <span class="ruby-identifier">status</span>(<span class="ruby-identifier">s</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">empty_json</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_json</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_json_array" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_json_array</span><span
            class="method-args">(r, s = 202)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_json_array-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_json_array</span>(<span class="ruby-identifier">r</span>, <span class="ruby-identifier">s</span> = <span class="ruby-value">202</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">EnginesError</span>)
    <span class="ruby-identifier">return_error_array</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-string">&#39;application/json&#39;</span>
    <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Access-Control-Allow-Origin&#39;</span>] =<span class="ruby-string">&#39;*&#39;</span>
    <span class="ruby-identifier">status</span>(<span class="ruby-identifier">s</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">r</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">FalseClass</span>)
      <span class="ruby-identifier">empty_array</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_json</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_text</span><span
            class="method-args">(r, s = 202)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_text-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_text</span>(<span class="ruby-identifier">r</span>, <span class="ruby-identifier">s</span> = <span class="ruby-value">202</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">status</span>(<span class="ruby-value">204</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">TrueClass</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">FalseClass</span>)
      <span class="ruby-identifier">return_boolean</span>(<span class="ruby-identifier">r</span>, <span class="ruby-identifier">s</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">EnginesError</span>)
      <span class="ruby-identifier">return_error</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">content_type</span> <span class="ruby-string">&#39;text/plain&#39;</span>
      <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Access-Control-Allow-Origin&#39;</span>] =<span class="ruby-string">&#39;*&#39;</span>
      <span class="ruby-identifier">status</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-return_true" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">return_true</span><span
            class="method-args">(s = 200)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="return_true-source">
            <pre><span class="ruby-comment"># File server/helpers/output.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_true</span>(<span class="ruby-identifier">s</span> = <span class="ruby-value">200</span>)
  <span class="ruby-identifier">return_text</span>(<span class="ruby-string">&#39;true&#39;</span>, <span class="ruby-identifier">s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-send_encoded_exception" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_encoded_exception</span><span
            class="method-args">(api_exception)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="send_encoded_exception-source">
            <pre><span class="ruby-comment"># File server/helpers/errors.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_encoded_exception</span>(<span class="ruby-identifier">api_exception</span>)<span class="ruby-comment">#request, error_object, *args)</span>
  <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>] = <span class="ruby-identifier">fake_exception</span>(<span class="ruby-identifier">api_exception</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Exception</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">EnginesException</span>)
    <span class="ruby-keyword">unless</span>  <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">status</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">status_code</span> = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">status</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">level</span> <span class="ruby-operator">==</span> <span class="ruby-value">:warning</span>
        <span class="ruby-identifier">status_code</span> = <span class="ruby-value">405</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">status_code</span> = <span class="ruby-value">406</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">status_code</span> = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:status</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:status</span>)
  <span class="ruby-identifier">status_code</span> = <span class="ruby-value">500</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">status_code</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-identifier">error_mesg</span> = {
      <span class="ruby-identifier">route</span><span class="ruby-operator">:</span> <span class="ruby-identifier">request</span>,
      <span class="ruby-identifier">error_object</span><span class="ruby-operator">:</span> {}
    }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">error_mesg</span> = {
      <span class="ruby-identifier">route</span><span class="ruby-operator">:</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">fullpath</span>,
      <span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">request_method</span>,
     <span class="ruby-comment"># query: request.query_string, Dont this may be huge</span>
      <span class="ruby-identifier">params</span><span class="ruby-operator">:</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>,
      <span class="ruby-identifier">error_object</span><span class="ruby-operator">:</span> {}
    }
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;send_encoded_exception with request &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">api_exception</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">EnginesException</span>)
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:error_object</span>] = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">to_h</span>
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:params</span>] = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:params</span>].<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Exception</span>)
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:error_object</span>] = {<span class="ruby-identifier">error_mesg</span><span class="ruby-operator">:</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">error_type</span><span class="ruby-operator">:</span> <span class="ruby-value">:failure</span>}
    <span class="ruby-identifier">error_mesg</span>[<span class="ruby-value">:source</span>] = <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-comment">#  error_mesg[:error_mesg] = api_exception[:exception].to_s</span>
    <span class="ruby-identifier">status_code</span> = <span class="ruby-value">500</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">api_exception</span>[<span class="ruby-value">:exception</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;unauthorised&#39;</span>
    <span class="ruby-identifier">status_code</span> = <span class="ruby-value">403</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">error_mesg</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">return_json</span>(<span class="ruby-identifier">error_mesg</span>, <span class="ruby-identifier">status_code</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;  &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-identifier">status_code</span> = <span class="ruby-value">500</span>
  <span class="ruby-comment">#  send_encoded_exception(request: &#39;send_encoded_exception&#39;, exception: e, status: 500)</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-service_hash_from_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">service_hash_from_params</span><span
            class="method-args">(params, search)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="service_hash_from_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">service_hash_from_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">search</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">search</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:type_path</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;splat&#39;</span>][<span class="ruby-value">0</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:type_path</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;splat&#39;</span>][<span class="ruby-value">0</span>])
    <span class="ruby-identifier">params</span>[<span class="ruby-value">:service_handle</span>] = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;splat&#39;</span>][<span class="ruby-value">0</span>])
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">params</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-service_service_hash_from_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">service_service_hash_from_params</span><span
            class="method-args">(params, search = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="service_service_hash_from_params-source">
            <pre><span class="ruby-comment"># File server/helpers/params.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">service_service_hash_from_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">search</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">service_hash_from_params</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">search</span>)
  <span class="ruby-identifier">hash</span>[<span class="ruby-value">:parent_engine</span>] = <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;service_name&#39;</span>]
  <span class="ruby-identifier">hash</span>[<span class="ruby-value">:container_type</span>] = <span class="ruby-string">&#39;service&#39;</span>
  <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-source_is_service-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">source_is_service?</span><span
            class="method-args">(request, service_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="source_is_service-3F-source">
            <pre><span class="ruby-comment"># File server/engine_server.rb, line 88</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">source_is_service?</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">service_name</span>)
  <span class="ruby-identifier">service</span> = <span class="ruby-identifier">get_service</span>(<span class="ruby-identifier">service_name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">ip</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">service</span>.<span class="ruby-identifier">get_ip_str</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stream_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stream_file</span><span
            class="method-args">(uri_s, src_f, headers = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="stream_file-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stream_file</span>(<span class="ruby-identifier">uri_s</span>, <span class="ruby-identifier">src_f</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">headers</span> = {
     <span class="ruby-string">&#39;Content-Type&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;application/octet-stream&#39;</span>,
    <span class="ruby-string">&#39;Accept-Encoding&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;gzip&#39;</span>,
     <span class="ruby-string">&#39;ACCESS_TOKEN&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">load_token</span>,
   <span class="ruby-comment"># &#39;Transfer-Encoding&#39; =&gt; &#39;chunked&#39;</span>
     <span class="ruby-string">&#39;Content-Length&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">src_f</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span>
  } <span class="ruby-keyword">if</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-comment"># STDERR.puts(&#39;stream header &#39; + headers.to_s)</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>(<span class="ruby-ivar">@base_url</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri_s</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;uri &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>)  
  <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">use_ssl</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">verify_mode</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">SSL</span><span class="ruby-operator">::</span><span class="ruby-constant">VERIFY_NONE</span>
 <span class="ruby-comment"># if  post == true</span>
<span class="ruby-comment">#  request = Net::HTTP::Post.new(uri.request_uri, headers)</span>
<span class="ruby-comment">#  else</span>
    <span class="ruby-identifier">request</span> = <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Put</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">request_uri</span>, <span class="ruby-identifier">headers</span>)
 <span class="ruby-comment"># STDERR.puts(&#39;request &#39; + request.to_s)</span>
<span class="ruby-comment">#  end</span>
  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">body_stream</span> = <span class="ruby-identifier">src_f</span>
 <span class="ruby-identifier">r</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">request</span>)
<span class="ruby-comment">#   conn.start do |http| </span>
 <span class="ruby-comment">#  r = http.request(request)</span>
 <span class="ruby-comment">#STDERR.puts(&#39;STREAM RESULT &#39; + r.inspect + &#39;:&#39; + r.body.to_s)</span>
<span class="ruby-comment">#   end</span>
<span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
    <span class="ruby-identifier">exit</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;socket stream closed &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stream_io" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stream_io</span><span
            class="method-args">(uri_s, io_h)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="stream_io-source">
            <pre><span class="ruby-comment"># File client/client_http_requests.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stream_io</span>(<span class="ruby-identifier">uri_s</span>, <span class="ruby-identifier">io_h</span>)
  <span class="ruby-identifier">headers</span> = {
     <span class="ruby-string">&#39;content-type&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;application/octet-stream&#39;</span>,
     <span class="ruby-string">&#39;Accept-Encoding&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;gzip&#39;</span>,
     <span class="ruby-string">&#39;ACCESS_TOKEN&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">load_token</span>,
    <span class="ruby-string">&#39;Transfer-Encoding&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;chunked&#39;</span>
   <span class="ruby-comment">#  &#39;Content-Length&#39; =&gt; src_f.size.to_s</span>
  } 
  <span class="ruby-identifier">stream_file</span>(<span class="ruby-identifier">uri_s</span>, <span class="ruby-identifier">io_h</span>, <span class="ruby-identifier">headers</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stream_put" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stream_put</span><span
            class="method-args">(data_io)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="stream_put-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stream_put</span>(<span class="ruby-identifier">data_io</span>)
  <span class="ruby-identifier">rest_stream_put</span>(<span class="ruby-ivar">@route</span>, <span class="ruby-identifier">data_io</span>)
  <span class="ruby-identifier">exit</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-token_owner" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">token_owner</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="token_owner-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">token_owner</span>
  <span class="ruby-identifier">tok_params</span> = <span class="ruby-identifier">$user_tokens</span>[<span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCESS_TOKEN&#39;</span>]]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">tok_params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-string">&#39;sysadmin&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">tok_params</span>[<span class="ruby-value">:user_name</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-token_owner_password" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">token_owner_password</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="token_owner_password-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">token_owner_password</span>
  <span class="ruby-identifier">tok_params</span> = <span class="ruby-identifier">$user_tokens</span>[<span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCESS_TOKEN&#39;</span>]]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">tok_params</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">tok_params</span>[<span class="ruby-value">:password</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uadmin_del" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uadmin_del</span><span
            class="method-args">(splat, params, body)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uadmin_del-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uadmin_del</span>(<span class="ruby-identifier">splat</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">uconnection</span>
  <span class="ruby-identifier">body</span> = <span class="ruby-identifier">process_body</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">request</span>({<span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:delete</span>,
    <span class="ruby-identifier">query</span><span class="ruby-operator">:</span> <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>),
    <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">body</span>,
    <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">build_uri</span>(<span class="ruby-identifier">splat</span>)})
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">handle_exeception</span>(<span class="ruby-identifier">e</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">reset</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uadmin_get" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uadmin_get</span><span
            class="method-args">(splat, params, body)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uadmin_get-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uadmin_get</span>(<span class="ruby-identifier">splat</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">body</span> = <span class="ruby-identifier">process_body</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">uconnection</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">request</span>({<span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:get</span>,
    <span class="ruby-identifier">query</span><span class="ruby-operator">:</span> <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>),
    <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">body</span>,
    <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">build_uri</span>(<span class="ruby-identifier">splat</span>)})
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">handle_exeception</span>(<span class="ruby-identifier">e</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">reset</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uadmin_post" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uadmin_post</span><span
            class="method-args">(splat, params, body)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uadmin_post-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uadmin_post</span>(<span class="ruby-identifier">splat</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">body</span>)
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>( <span class="ruby-string">&#39;Post Body &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span>)

  <span class="ruby-identifier">rheaders</span> = {}
  <span class="ruby-identifier">rheaders</span>[<span class="ruby-string">&#39;content_type&#39;</span>] = <span class="ruby-string">&#39;application/json&#39;</span>
  <span class="ruby-identifier">body</span> = <span class="ruby-identifier">process_body</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">uconnection</span>
  <span class="ruby-identifier">r</span> = {<span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:post</span>,
    <span class="ruby-identifier">query</span><span class="ruby-operator">:</span> <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>),
    <span class="ruby-identifier">headers</span><span class="ruby-operator">:</span> <span class="ruby-identifier">rheaders</span>,
    <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">build_uri</span>(<span class="ruby-identifier">splat</span>),
    <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">body</span>}
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Request &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">request</span>(<span class="ruby-identifier">r</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>( <span class="ruby-string">&#39;EXE &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">handle_exeception</span>(<span class="ruby-identifier">e</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">reset</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uadmin_put" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uadmin_put</span><span
            class="method-args">(splat, params, body)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uadmin_put-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uadmin_put</span>(<span class="ruby-identifier">splat</span>, <span class="ruby-identifier">params</span>, <span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">uconnection</span>
  <span class="ruby-identifier">rheaders</span> = {}
  <span class="ruby-identifier">rheaders</span>[<span class="ruby-string">&#39;content_type&#39;</span>] = <span class="ruby-string">&#39;application/json&#39;</span>

  <span class="ruby-identifier">body</span> = <span class="ruby-identifier">process_body</span>(<span class="ruby-identifier">body</span>)
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">request</span>({<span class="ruby-identifier">method</span><span class="ruby-operator">:</span> <span class="ruby-value">:put</span>,
    <span class="ruby-identifier">query</span><span class="ruby-operator">:</span> <span class="ruby-identifier">clean_params</span>(<span class="ruby-identifier">params</span>),
    <span class="ruby-identifier">path</span><span class="ruby-operator">:</span> <span class="ruby-identifier">build_uri</span>(<span class="ruby-identifier">splat</span>),
    <span class="ruby-identifier">headers</span><span class="ruby-operator">:</span> <span class="ruby-identifier">rheaders</span>,
    <span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-identifier">body</span>})
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">handle_exeception</span>(<span class="ruby-identifier">e</span>)
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">reset</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uadmin_response" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uadmin_response</span><span
            class="method-args">(r)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uadmin_response-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uadmin_response</span>(<span class="ruby-identifier">r</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Response</span>)
      <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_json</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Response got &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; headers &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">headers</span>.<span class="ruby-identifier">to_s</span> )
      <span class="ruby-identifier">content_type</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>]
      <span class="ruby-identifier">status</span>(<span class="ruby-identifier">r</span>.<span class="ruby-identifier">status</span>)
      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Got Status &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_s</span>)
      <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Got Content &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">to_s</span>)
      <span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-uconnection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">uconnection</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="uconnection-source">
            <pre><span class="ruby-comment"># File server/api/system/uadmin/uadmin_verbs.rb, line 1</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uconnection</span>
  <span class="ruby-constant">Excon</span>.<span class="ruby-identifier">new</span>( <span class="ruby-string">&#39;http://uadmin:8000&#39;</span>,
  <span class="ruby-identifier">debug_request</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">debug_response</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">ssl_verify_peer</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>,
  <span class="ruby-identifier">persistent</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>,
  <span class="ruby-identifier">headers</span><span class="ruby-operator">:</span> {<span class="ruby-string">&#39;content_type&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;application/json&#39;</span>}) <span class="ruby-comment">#content_type})</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Excon</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Failed to open base url &#39;</span> <span class="ruby-operator">+</span>   <span class="ruby-string">&#39;http://uadmin:8000&#39;</span>  <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@retries</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">5</span>
    <span class="ruby-ivar">@retries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">status</span>(<span class="ruby-value">405</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span><span class="ruby-identifier">e</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Uncatch E &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-unauthenticated" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unauthenticated</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="unauthenticated-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unauthenticated</span>
  <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-string">&#39;Warden Strat unauth&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-valid-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">valid?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="valid-3F-source">
            <pre><span class="ruby-comment"># File server/warden/warden_strategies.rb, line 3</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">valid?</span>
  <span class="ruby-comment"># STDERR.puts(&#39;NO HTTP_ACCESS_TOKEN in header &#39;) if request.env[&#39;HTTP_ACCESS_TOKEN&#39;].nil?</span>
  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCESS_TOKEN&#39;</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-warning_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">warning_hash</span><span
            class="method-args">(mesg, params = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="warning_hash-source">
            <pre><span class="ruby-comment"># File server/helpers/errors.rb, line 11</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">warning_hash</span>(<span class="ruby-identifier">mesg</span>, <span class="ruby-identifier">params</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">error_hash</span>(<span class="ruby-identifier">mesg</span>, <span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">r</span> [<span class="ruby-value">:error_type</span>] = <span class="ruby-value">:warning</span>
  <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-write_response" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">write_response</span><span
            class="method-args">(r)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="write_response-source">
            <pre><span class="ruby-comment"># File client/main.rb, line 129</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write_response</span>(<span class="ruby-identifier">r</span>)
 <span class="ruby-comment"># STDERR.puts(&#39;Response Class for name &#39; + r.class.name)</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">log_error</span>(<span class="ruby-string">&#39;nil response&#39;</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;application/octet-stream&#39;</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">b</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">expect_json</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">expect_json</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;application/json&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">body</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;{&#39;</span>)    
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">handle_resp</span>(<span class="ruby-identifier">r</span>, <span class="ruby-identifier">expect_json</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">log_error</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; with :&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">log_error</span>(<span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@verbose</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

